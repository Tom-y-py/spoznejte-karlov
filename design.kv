#:kivy 2.0
#:import hex kivy.utils.get_color_from_hex
#:import dp kivy.metrics.dp
#:import sp kivy.metrics.sp

<ClickablePane@ButtonBehavior+RelativeLayout>:
<ClickableImageContainer@ButtonBehavior+RelativeLayout>:

# ==========================================
# 1. ZÁKLADNÍ DEFINICE A MODERNÍ PRVKY
# ==========================================

<Label>:
    # Nyní odkazujeme na název rodiny fontu, kterou jsme registrovali v Pythonu
    font_name: 'Roboto'
    color: hex('#eeeeee')
    font_size: sp(18)

# --- MODERNÍ TLAČÍTKO S VISUAL FEEDBACKEM ---
<NavButton@ButtonBehavior+Label>:
    my_bg_color: hex('#d4af37')
    
    canvas.before:
        # 1. STÍN (Zůstává na místě, vytváří hloubku)
        Color:
            rgba: 0, 0, 0, 0.4
        RoundedRectangle:
            pos: self.x + dp(4), self.y - dp(4)
            size: self.size
            radius: [dp(10), dp(10), dp(10), dp(10)]
        
        # 2. HLAVNÍ TLAČÍTKO (Hýbe se při stisku)
        Color:
            rgba: (self.my_bg_color or hex('#d4af37')) if self.state == 'normal' else hex('#b59020')
            
        RoundedRectangle:
            # ZDE JE TA MAGIE:
            # Pokud je stisknuto ('down'), posuneme tlačítko o 2px dolů a doprava (k stínu)
            pos: (self.x + dp(2), self.y - dp(2)) if self.state == 'down' else self.pos
            size: self.size
            radius: [dp(10), dp(10), dp(10), dp(10)]
    
    color: hex('#000000')
    font_size: sp(18)
    bold: True
    size_hint: None, None
    size: dp(200), dp(60)
    halign: 'center'
    valign: 'middle'

# --- KARTA (Card) ---
<Card@RelativeLayout>:
    canvas.before:
        # Stín
        Color:
            rgba: 0, 0, 0, 0.5
        RoundedRectangle:
            pos: dp(5), -dp(5) 
            size: self.size
            radius: [dp(15), dp(15), dp(15), dp(15)]
        
        # Pozadí karty
        Color:
            rgba: hex('#252525')
        RoundedRectangle:
            pos: 0, 0
            size: self.size
            radius: [dp(15), dp(15), dp(15), dp(15)]
            
        # Jemný obrys
        Color:
            rgba: 1, 1, 1, 0.1
        Line:
            rounded_rectangle: (0, 0, self.width, self.height, dp(15))
            width: dp(1)

# ==========================================
# 2. KOMPONENTY PRO GALERII
# ==========================================

<GalleryBlock>:
    orientation: 'vertical'
    size_hint_y: None
    height: dp(600) 
    spacing: dp(15)
    padding: [0, dp(10), 0, dp(20)]
    
    Card:
        size_hint: 1, 1
        
        BoxLayout:
            orientation: 'vertical'
            padding: dp(15)
            spacing: dp(10)

            # Klikatelný obrázek
            ClickableImageContainer:
                size_hint_y: 0.7
                on_release: if root.click_action: root.click_action()
                
                Image:
                    id: block_img
                    source: root.img_source
                    allow_stretch: True
                    keep_ratio: True
                    fit_mode: "cover" 
                    
                    canvas.before:
                        StencilPush
                        RoundedRectangle:
                            pos: self.x, self.y
                            size: self.width, self.height
                            radius: [dp(10), dp(10), 0, 0] 
                        StencilUse
                    canvas.after:
                        StencilUnUse
                        RoundedRectangle:
                            pos: self.x, self.y
                            size: self.width, self.height
                            radius: [dp(10), dp(10), 0, 0]
                        StencilPop

                # Ikonka lupy
                Label:
                    text: "+"
                    font_size: sp(30)
                    bold: True
                    size_hint: None, None
                    size: dp(60), dp(60)
                    pos_hint: {'right': 0.95, 'y': 0.08}
                    color: hex('#d4af37')
                    canvas.before:
                        Color:
                            rgba: 0, 0, 0, 0.7
                        Ellipse:
                            pos: self.pos
                            size: self.size

            # Text pod obrázkem
            Label:
                text: root.text_content
                size_hint_y: 0.3
                text_size: self.width, None
                halign: 'center'
                valign: 'top'
                font_size: sp(20)
                color: hex('#eeeeee')

# --- DLAŽDICE MENU (ImageTile) ---
<ImageTile@ButtonBehavior+FloatLayout>:
    img_source: ''
    title_text: ''
    
    canvas.before:
        # Stín
        Color:
            rgba: 0, 0, 0, 0.5
        RoundedRectangle:
            pos: self.x + dp(5), self.y - dp(5)
            size: self.size
            radius: [dp(15), dp(15), dp(15), dp(15)]
            
        # Ořez - ZAČÁTEK
        StencilPush
        RoundedRectangle:
            pos: self.pos
            size: self.size
            radius: [dp(15), dp(15), dp(15), dp(15)]
        StencilUse
    
    canvas.after:
        # Ořez - KONEC
        StencilUnUse
        RoundedRectangle:
            pos: self.pos
            size: self.size
            radius: [dp(15), dp(15), dp(15), dp(15)]
        StencilPop

        # Zlatý rámeček
        Color:
            rgba: hex('#d4af37')
        Line:
            width: dp(2)
            rounded_rectangle: (self.x, self.y, self.width, self.height, dp(15))

    Image:
        source: root.img_source
        allow_stretch: True
        keep_ratio: False
        fit_mode: "cover"
        opacity: 0.9
        size_hint: 1, 1
        pos_hint: {'center_x': 0.5, 'center_y': 0.5}

        # Filtr
        canvas.after:
            Color:
                rgba: 0, 0, 0, 0.4
            Rectangle:
                pos: self.pos
                size: self.size

    Label:
        text: root.title_text
        font_size: sp(24)
        bold: True
        text_size: self.width - dp(20), None
        halign: 'center'
        valign: 'center'
        pos_hint: {'center_x': 0.5, 'center_y': 0.5}
        color: hex('#ffffff')

# ==========================================
# 3. ROZLOŽENÍ OBRAZOVEK
# ==========================================

# --- MAIN MENU ---
<MainMenu>:
    canvas.before:
        Color: 
            rgba: hex('#101010')
        Rectangle: 
            pos: self.pos
            size: self.size
    
    BoxLayout:
        orientation: 'horizontal'
        spacing: dp(4) 
        
        ClickablePane:
            size_hint_x: 0.5
            on_release: app.root.current = 'section_a'
            Image:
                source: 'assets/Karl_Freiherr_von_Skoda,_Erfinder_der_Motorbatterien_1916_J._Vilímek.png' 
                fit_mode: "cover"
                opacity: 0.5
            Label:
                text: "Kdo byl\nPlzeňský Baťa?"
                font_size: sp(50)
                bold: True
                halign: 'center'
                pos_hint: {'center_x': 0.5, 'center_y': 0.5}
        
        ClickablePane:
            size_hint_x: 0.5
            on_release: app.root.current = 'section_b'
            Image:
                source: 'assets/Soucasnost.jpg'
                fit_mode: "cover"
                opacity: 0.5
            Label:
                text: "Prozkoumej\nKarlov"
                font_size: sp(50)
                bold: True
                halign: 'center'
                pos_hint: {'center_x': 0.5, 'center_y': 0.5}

# --- KAREL ŠKODA (SECTION A) ---
<SectionA>:
    canvas.before:
        Color: 
            rgba: hex('#1a1a1a')
        Rectangle: 
            pos: self.pos
            size: self.size
            
    FloatLayout:
        Label:
            text: "Karel Škoda (1878-1929)"
            font_size: sp(40)
            bold: True
            color: hex('#d4af37')
            size_hint: 1, 0.12
            pos_hint: {'top': 1}
            
        BoxLayout:
            orientation: 'horizontal'
            padding: dp(40)
            spacing: dp(40)
            size_hint: 1, 0.78
            pos_hint: {'top': 0.88}
            
            # Levý sloupec
            Card:
                size_hint: 0.55, 1
                ScrollView:
                    size_hint: 1, 1
                    bar_width: dp(10)
                    bar_color: hex('#d4af37')
                    bar_inactive_color: hex('#333333')
                    padding: dp(20)
                    
                    Label:
                        text: root.text_content
                        markup: True
                        text_size: self.width, None
                        size_hint_y: None
                        height: self.texture_size[1]
                        font_size: sp(22)
                        line_height: 1.4
                        valign: 'top'
                        padding: [dp(20), dp(20)]

            # Pravý sloupec
            BoxLayout:
                orientation: 'vertical'
                size_hint: 0.45, 1
                spacing: dp(20)
                
                # --- KLIKACÍ KARTA S FOTKOU ---
                Card:
                    size_hint_y: 0.45
                    BoxLayout:
                        orientation: 'vertical'
                        padding: dp(10)
                        spacing: dp(5)
                        
                        ClickableImageContainer:
                            size_hint_y: 0.85
                            on_release: root.show_detail("Emil a Karel Škodovi", "assets/A1.jpg", "Dobová fotografie zachycující zakladatele Emila Škodu se synem Karlem.")
                            
                            Image:
                                source: 'assets/A1.jpg'
                                fit_mode: "contain"
                                
                            Label:
                                text: "+"
                                font_size: sp(20)
                                bold: True
                                size_hint: None, None
                                size: dp(40), dp(40)
                                pos_hint: {'right': 0.98, 'bottom': 0.02}
                                color: hex('#d4af37')
                                canvas.before:
                                    Color:
                                        rgba: 0, 0, 0, 0.7
                                    Ellipse:
                                        pos: self.pos
                                        size: self.size
                        
                        Label:
                            text: "Emil Škoda se synem Karlem"
                            font_size: sp(16)
                            color: hex('#aaaaaa')
                            size_hint_y: 0.15
                            text_size: self.size
                            halign: 'center'
                            valign: 'top'
                
                # --- GridLayout s tlačítky ---
                GridLayout:
                    cols: 2
                    spacing: dp(15)
                    size_hint_y: 0.55
                    
                    NavButton:
                        text: "Konzumní družstvo"
                        size_hint: 1, 1 
                        font_size: sp(16)
                        on_release: root.show_detail("Konzumní družstvo", "assets/A2.jpg", "Budovy bývalého konzumního družstva...")
                    NavButton:
                        text: "Kulturní dům"
                        size_hint: 1, 1
                        font_size: sp(16)
                        on_release: root.show_detail("Kulturní dům", "assets/A3.jpg", "Bývalý kulturní dům Nebe...")
                    NavButton:
                        text: "Čtvrť Karlov"
                        size_hint: 1, 1
                        font_size: sp(16)
                        on_release: root.show_detail("Čtvrť Karlov", "assets/A4.jpg", "Jeden z obytných domů...")
                    NavButton:
                        text: "Ohradní zeď"
                        size_hint: 1, 1
                        font_size: sp(16)
                        on_release: root.show_detail("Ohradní zeď", "assets/A5.jpg", "Ohradní zeď Škodových závodů...")
                    
                    NavButton:
                        text: "Techmania"
                        size_hint: 1, 1
                        font_size: sp(16)
                        on_release: root.show_detail("Techmania", "assets/A6.jpg", "Historická budova, kde dnes sídlí Techmania Science Center.")
                    NavButton:
                        text: "Planetárium"
                        size_hint: 1, 1
                        font_size: sp(16)
                        on_release: root.show_detail("Planetárium", "assets/A7.jpg", "Budova dnešního planetária je další z významných staveb v areálu.")
        
        NavButton:
            text: "< Na začátek"
            pos_hint: {'x': 0.05, 'y': 0.03}
            on_release: app.root.current = 'menu'
            my_bg_color: hex('#757575')
                    
        NavButton:
            text: "Objev Karlov >"
            pos_hint: {'right': 0.95, 'y': 0.03}
            on_release: app.root.current = 'section_b'

# --- ROZCESTNÍK B (SECTION B) ---
<SectionB>:
    canvas.before:
        Color: 
            rgba: hex('#1a1a1a')
        Rectangle: 
            pos: self.pos
            size: self.size
            
    FloatLayout:
        Label:
            text: "Čtvrť Karlov"
            font_size: sp(40)
            bold: True
            color: hex('#d4af37')
            size_hint: 0.50, 0.1
            pos_hint: {'x': 0.05, 'top': 0.98}
            halign: 'left'
            text_size: self.size
            
        Label:
            text: root.text_content
            text_size: self.width, None
            size_hint: 0.50, None
            height: self.texture_size[1]
            halign: 'left'
            valign: 'top'
            font_size: sp(22)
            pos_hint: {'x': 0.05, 'top': 0.83}
        
        Card:
            size_hint: 0.35, 0.45
            pos_hint: {'right': 0.95, 'top': 0.95}
            
            Image:
                id: slideshow_image
                fit_mode: "cover"
                size_hint: 0.95, 0.95
                pos_hint: {'center_x': 0.5, 'center_y': 0.5}
                radius: [dp(10), dp(10), dp(10), dp(10)]
                
        BoxLayout:
            orientation: 'horizontal'
            spacing: dp(30)
            size_hint: 0.9, 0.30
            pos_hint: {'center_x': 0.5, 'y': 0.15}
            
            ImageTile:
                title_text: "Jak se stavěl\nKarlov"
                img_source: 'assets/Ba.jpg'
                on_release: app.root.current = 'section_b1'
            ImageTile:
                title_text: "Život na\nKarlově"
                img_source: 'assets/Bb.jpg'
                on_release: app.root.current = 'section_b2'
            ImageTile:
                title_text: "Dvojí zánik\nKarlova"
                img_source: 'assets/Bc.jpg'
                on_release: app.root.current = 'section_b3'
        
        BoxLayout:
            orientation: 'horizontal'
            spacing: dp(20)
            size_hint: None, None
            size: dp(450), dp(80)
            pos_hint: {'right': 0.95, 'y': 0.02}
            
            NavButton:
                text: "Karel Škoda"
                on_release: app.root.current = 'section_a'
            NavButton:
                text: "Na začátek"
                on_release: app.root.current = 'menu'
                my_bg_color: hex('#757575')

# --- B1: JAK SE STAVĚL KARLOV ---
<SectionB1>:
    canvas.before:
        Color:
            rgba: hex('#1a1a1a')
        Rectangle:
            pos: self.pos
            size: self.size

    FloatLayout:
        Label:
            text: "Jak se stavěl Karlov"
            font_size: sp(40)
            bold: True
            color: hex('#d4af37')
            size_hint: 1, 0.1
            pos_hint: {'top': 1}
        
        ScrollView:
            size_hint: 0.9, 0.78
            pos_hint: {'center_x': 0.5, 'top': 0.88}
            bar_width: dp(10)
            bar_color: hex('#d4af37')
            
            BoxLayout:
                orientation: 'vertical'
                size_hint_y: None
                height: self.minimum_height 
                spacing: dp(30)
                padding: [dp(20), dp(20), dp(20), dp(50)]

                Card:
                    size_hint_y: None
                    height: intro_lbl.texture_size[1] + dp(40)
                    
                    Label:
                        id: intro_lbl
                        text: root.intro_text
                        text_size: self.width - dp(40), None
                        size_hint: 1, None
                        height: self.texture_size[1]
                        halign: 'center'
                        pos_hint: {'center_x': 0.5, 'center_y': 0.5}
                        font_size: sp(22)

                GalleryBlock:
                    img_source: 'assets/B1a.jpg'
                    text_content: root.desc_b1a
                    click_action: lambda: root.show_timed_popup("Plány čtvrtě", "assets/B1a.jpg")

                GalleryBlock:
                    img_source: 'assets/B1b.jpg'
                    text_content: root.desc_b1b
                    click_action: lambda: root.show_timed_popup("Výstavba domů", "assets/B1b.jpg")

                GalleryBlock:
                    img_source: 'assets/B1c.jpg'
                    text_content: root.desc_b1c
                    click_action: lambda: root.show_timed_popup("Proměna Karlova", "assets/B1c.jpg", "assets/Soucasnost.jpg")

        BoxLayout:
            orientation: 'horizontal'
            size_hint: 1, 0.1
            pos_hint: {'y': 0}
            padding: [dp(20), dp(10), dp(20), dp(10)]
            canvas.before:
                Color:
                    rgba: hex('#1a1a1a')
                Rectangle:
                    pos: self.pos
                    size: self.size
                Color:
                    rgba: hex('#333333')
                Line:
                    points: [self.x, self.height, self.width, self.height]
                    width: 1

            NavButton:
                text: "< Na začátek"
                on_release: app.root.current = 'menu'
            
            Widget: 
                size_hint_x: 1 
            
            NavButton:
                text: "Zpět na rozcestník"
                my_bg_color: hex('#757575')
                on_release: app.root.current = 'section_b'

# --- B2: ŽIVOT NA KARLOVĚ ---
<SectionB2>:
    canvas.before:
        Color:
            rgba: hex('#1a1a1a')
        Rectangle:
            pos: self.pos
            size: self.size

    FloatLayout:
        Label:
            text: "Život na Karlově"
            font_size: sp(40)
            bold: True
            color: hex('#d4af37')
            size_hint: 1, 0.1
            pos_hint: {'top': 1}
        
        ScrollView:
            size_hint: 0.9, 0.78
            pos_hint: {'center_x': 0.5, 'top': 0.88}
            bar_width: dp(10)
            bar_color: hex('#d4af37')
            
            BoxLayout:
                orientation: 'vertical'
                size_hint_y: None
                height: self.minimum_height 
                spacing: dp(30)
                padding: [dp(20), dp(20), dp(20), dp(50)]

                Card:
                    size_hint_y: None
                    height: intro_lbl_b2.texture_size[1] + dp(40)
                    Label:
                        id: intro_lbl_b2
                        text: root.intro_text
                        text_size: self.width - dp(40), None
                        size_hint: 1, None
                        height: self.texture_size[1]
                        halign: 'center'
                        pos_hint: {'center_x': 0.5, 'center_y': 0.5}
                        font_size: sp(22)

                GalleryBlock:
                    img_source: 'assets/B2a.jpg'
                    text_content: root.desc_b2a
                    click_action: lambda: root.show_timed_popup("Škola na Karlově", "assets/B2a.jpg", "assets/B2a_in.jpg")

                GalleryBlock:
                    img_source: 'assets/B2b1.jpg'
                    text_content: root.desc_b2b
                    click_action: lambda: root.show_timed_popup("Lidový dům", "assets/B2b1.jpg", "assets/B2b2.jpg")

                GalleryBlock:
                    img_source: 'assets/B2c2.jpg'
                    text_content: root.desc_b2c
                    click_action: lambda: root.show_timed_popup("Sport a fotbal", "assets/B2c2.jpg", "assets/B2c1.png")

        BoxLayout:
            orientation: 'horizontal'
            size_hint: 1, 0.1
            pos_hint: {'y': 0}
            padding: [dp(20), dp(10), dp(20), dp(10)]
            canvas.before:
                Color:
                    rgba: hex('#1a1a1a')
                Rectangle:
                    pos: self.pos
                    size: self.size
                Color:
                    rgba: hex('#333333')
                Line:
                    points: [self.x, self.height, self.width, self.height]
                    width: 1

            NavButton:
                text: "< Na začátek"
                on_release: app.root.current = 'menu'
            Widget: 
                size_hint_x: 1 
            NavButton:
                text: "Zpět na rozcestník"
                my_bg_color: hex('#757575')
                on_release: app.root.current = 'section_b'

# --- B3: DVOJÍ ZÁNIK KARLOVA ---
<SectionB3>:
    canvas.before:
        Color:
            rgba: hex('#1a1a1a')
        Rectangle:
            pos: self.pos
            size: self.size

    FloatLayout:
        Label:
            text: "Dvojí zánik Karlova"
            font_size: sp(40)
            bold: True
            color: hex('#d4af37')
            size_hint: 1, 0.1
            pos_hint: {'top': 1}
        
        ScrollView:
            size_hint: 0.9, 0.78
            pos_hint: {'center_x': 0.5, 'top': 0.88}
            bar_width: dp(10)
            bar_color: hex('#d4af37')
            
            BoxLayout:
                orientation: 'vertical'
                size_hint_y: None
                height: self.minimum_height 
                spacing: dp(30)
                padding: [dp(20), dp(20), dp(20), dp(50)]

                Card:
                    size_hint_y: None
                    height: intro_lbl_b3.texture_size[1] + dp(40)
                    Label:
                        id: intro_lbl_b3
                        text: root.intro_text
                        text_size: self.width - dp(40), None
                        size_hint: 1, None
                        height: self.texture_size[1]
                        halign: 'center'
                        pos_hint: {'center_x': 0.5, 'center_y': 0.5}
                        font_size: sp(22)

                # --- 1. GALERIE: Nálety (B3a.jpg) - bez přepínání ---
                GalleryBlock:
                    img_source: 'assets/B3a.jpg'
                    text_content: root.desc_b3a
                    # Voláme popup pouze s jedním obrázkem
                    click_action: lambda: root.show_timed_popup("Nálety (1945)", "assets/B3a.jpg")

                # --- 2. GALERIE: Zástavba (B3b.jpg) - bez přepínání ---
                GalleryBlock:
                    img_source: 'assets/B3b.jpg'
                    text_content: root.desc_b3b
                    # Voláme popup pouze s jedním obrázkem
                    click_action: lambda: root.show_timed_popup("Zástavba Karlova", "assets/B3b.jpg")

        BoxLayout:
            orientation: 'horizontal'
            size_hint: 1, 0.1
            pos_hint: {'y': 0}
            padding: [dp(20), dp(10), dp(20), dp(10)]
            canvas.before:
                Color:
                    rgba: hex('#1a1a1a')
                Rectangle:
                    pos: self.pos
                    size: self.size
                Color:
                    rgba: hex('#333333')
                Line:
                    points: [self.x, self.height, self.width, self.height]
                    width: 1

            NavButton:
                text: "< Na začátek"
                on_release: app.root.current = 'menu'
            Widget: 
                size_hint_x: 1 
            NavButton:
                text: "Zpět na rozcestník"
                my_bg_color: hex('#757575')
                on_release: app.root.current = 'section_b'

# --- DETAILY (POPUPS) ---

<DetailPopup>:
    size_hint: 0.85, 0.85
    auto_dismiss: True
    background_color: 0, 0, 0, 0.9
    
    Card:
        size_hint: 1, 1
        
        BoxLayout:
            orientation: 'vertical'
            padding: dp(2)
            
            AnchorLayout:
                anchor_x: 'right'
                anchor_y: 'top'
                size_hint_y: 0.1
                padding: dp(10)
                
                # ZMĚNA: Zaoblené tlačítko X
                Button: 
                    text: "X"
                    size_hint: None, None
                    size: dp(60), dp(60)
                    background_color: 0, 0, 0, 0 # Průhledné pozadí
                    background_normal: ''
                    bold: True
                    on_release: root.dismiss()
                    canvas.before:
                        Color:
                            rgba: hex('#cc0000')
                        # Kruh (Ellipse)
                        Ellipse:
                            pos: self.pos
                            size: self.size
            
            Image: 
                source: root.img_source
                allow_stretch: True
                keep_ratio: True
                size_hint_y: 0.7
            
            Label: 
                text: root.desc_text
                font_size: sp(22)
                size_hint_y: 0.2
                text_size: self.width - dp(40), None
                halign: 'center'
                valign: 'middle'

<TimedDetailPopup>:
    size_hint: 1, 1
    auto_dismiss: True 
    background_color: 0, 0, 0, 0.9 

    FloatLayout:
        # 1. NEVIDITELNÉ TLAČÍTKO NA POZADÍ
        Button:
            text: ""
            background_color: 0, 0, 0, 0
            background_normal: ''
            size_hint: 1, 1
            pos_hint: {'x': 0, 'y': 0}
            on_release: root.dismiss()

        # 2. Samotný obrázek
        Image:
            id: content_img
            source: root.img_source
            allow_stretch: True
            keep_ratio: True
            size_hint: 0.9, 0.9
            pos_hint: {'center_x': 0.5, 'center_y': 0.5}

        # 3. Tlačítko PŘEPNOUT
        Button:
            text: "PŘEPNOUT POHLED" if root.img_source_2 else ""
            opacity: 1 if root.img_source_2 else 0
            disabled: not root.img_source_2
            size_hint: None, None
            size: dp(250), dp(60)
            pos_hint: {'center_x': 0.5, 'y': 0.05}
            background_color: hex('#d4af37')
            color: hex('#000000')
            bold: True
            on_release: root.toggle_image()

        # 4. Tlačítko ZAVŘÍT (Zaoblené X)
        Button:
            text: "X"
            size_hint: None, None
            size: dp(60), dp(60)
            pos_hint: {'right': 0.98, 'top': 0.98}
            background_color: 0, 0, 0, 0 # Průhledné pozadí
            background_normal: ''
            bold: True
            on_release: root.dismiss()
            canvas.before:
                Color:
                    rgba: hex('#cc0000')
                Ellipse:
                    pos: self.pos
                    size: self.size